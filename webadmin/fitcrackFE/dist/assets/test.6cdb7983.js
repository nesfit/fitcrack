import{n as o}from"./index.2fcccaca.js";import{I as l}from"./vue-infinite-loading.33b09e95.js";import"./vendor.6aa46313.js";var c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"logItem",class:t.classes},[s("v-row",{staticClass:"newOverlay px-2",class:{new:t.isNew},attrs:{align:"center"}},[s("span",{staticClass:"time pr-2"},[t._v(t._s(t.$moment.utc(t.time).local().format("D.M.YYYY H:mm:ss"))+": ")]),s("v-col",[t._t("default")],2),t.hostID?s("v-btn",{staticClass:"btns",attrs:{to:"hosts/"+t.hostID,icon:""}},[s("v-icon",[t._v("desktop_windows")])],1):t._e(),t.jobID?s("v-btn",{staticClass:"btns",attrs:{to:"jobs/"+t.jobID,icon:""}},[s("v-icon",[t._v("work")])],1):t._e()],1)],1)},_=[];const u={name:"LogItem",props:{type:{type:String,default:"LOG"},hostID:{type:[Number,null],default:null},jobID:{type:[Number,null],default:null},time:{type:String,default:""}},data(){return{isNew:!0}},computed:{classes(){switch(this.type){case"LOG":return"infolog";case"ERROR":return"error";case"WARN":return"warning"}}},mounted(){setTimeout(function(){this.isNew=!1}.bind(this),1e3)}},r={};var v=o(u,c,_,!1,d,"4ddf41f6",null,null);function d(t){for(let e in r)this[e]=r[e]}var m=function(){return v.exports}(),h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"logsCont",staticClass:"logsCont",attrs:{"infinite-wrapper":""}},[t._l(t.logs,function(n,j){return s("fc-log",{key:n.raw,attrs:{type:n.type,time:n.time,"host-i-d":n.host,"job-i-d":n.job}},[t._v(" "+t._s(n.log)+" ")])}),s("infinite-loading",{on:{infinite:t.loadLogs}},[s("v-progress-circular",{attrs:{slot:"spinner",size:"50",width:3,indeterminate:"",color:"primary"},slot:"spinner"}),s("span",{attrs:{slot:"no-more"},slot:"no-more"},[t._v(" You reached the end of file. ")]),s("span",{attrs:{slot:"no-results"},slot:"no-results"},[t._v(" You reached the end of file. ")])],1)],2)},f=[];const p={name:"LogsView",components:{"fc-log":m,InfiniteLoading:l},data(){return{height:0,logs:[],skipCount:0,lastLog:null,interval:null}},mounted(){this.interval=setInterval(function(){this.loadNewLogs()}.bind(this),2500)},beforeDestroy:function(){clearInterval(this.interval)},methods:{loadLogs(t){this.axios.get(this.$serverAddr+"/log",{params:{skip_count:this.skipCount,last_log:this.lastLog}}).then(e=>{this.logs=this.logs.concat(e.data.items),this.lastLog=e.data.items[e.data.items.length-1].raw,this.skipCount+=e.data.items.length,t.loaded()}).catch(e=>{t.complete()})},loadNewLogs(t){this.logs.length!==0&&this.axios.get(this.$serverAddr+"/log/new",{params:{log:this.logs[0].raw}}).then(e=>{this.logs=e.data.items.concat(this.logs),this.skipCount+=e.data.items.length,this.$refs.logsCont.scrollTop>100&&this.$nextTick(()=>{this.$refs.logsCont.scrollTop+=e.data.items.length*52})})}}},i={};var g=o(p,h,f,!1,w,"4b343e40",null,null);function w(t){for(let e in i)this[e]=i[e]}var y=function(){return g.exports}(),$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",[s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("test-element",[t._v(" test ")])],1)],1)],1)},b=[];const x={name:"Test",components:{"test-element":y},data(){return{}}},a={};var C=o(x,$,b,!1,I,"4f9c8d3e",null,null);function I(t){for(let e in a)this[e]=a[e]}var N=function(){return C.exports}();export{N as default};
